#!/bin/bash

#si le shell n'est pas interactif, ne rien faire pour ne
# pas défoncer scp & co
if [[ $- != *i* ]] ; then
	return
fi

#emacs : what else.
export EDITOR='emacsclient -a emacs'
#ignorer les commandes débiles dans l'historique, et en mettre un de taille correcte
export HISTIGNORE="&:ls:[bf]g:cd:c"
export HISTSIZE=2000
export HISTFILESIZE=2000
#standard mais on sait jamais
export PATH=~/bin:$PATH
#prompt 
export PS1='\u@\h:\w\$ '

#M-q = effacer le dernier mot
bind '"\eq":backward-kill-word'

#à décommenter pour activer les core dump
# ulimit -c unlimited >/dev/null 2>&1

# ls après chaque cd, parce qu'il est scientifiquement prouvé que 42%
# des gens font un ls après chaque cd.  Chiant pour des scripts style
# for i in * ; do cd $i ; do_stuff ; cd .. ; done : dans ces cas-là,
# mettre builtin cd à la place de cd.
cd() {
builtin cd "$@" && ls --color=auto
}

#accueillir l'utilisateur avec un affichage de ~
ls --color=auto


# les alias
# -------------------- Emacs --------------------
#what else
alias e='emacs'
#mode console
alias enw='emacs -nw'
#ouvrir un fichier dans la session d'emacs en cours, et si emacs ne tourne pas, le lancer
alias ec='emacsclient --no-wait -a emacs'
#connection à un emacs en cours
alias re='emacsclient -c'
#connection à un emacs en cours en console
alias renw='emacsclient -t'

# -------------------- Autres --------------------
#affichage de la progression dans le fichier en bas de less
alias less='less -M'
#affichage d'un processus
alias proc='ps aux | grep'
#potentiellement l'alias le plus utile de tous
alias c='cd ..'
#normalement par défaut dans les distros censées, mais bon
alias ls='ls --color=auto'
# utile pour faire p.ex. make && coin
alias coin='play /usr/share/gnubiff/coin.wav'
#laisser gnome choisir le programme à utiliser
alias o='gnome-open'
#w, sans duplicata et trié
alias w='w | sort | uniq -w 4 | grep -v USER | grep -v "load average"'
#pour pouvoir débugger un programme juste en ajoutant gdb devant.
#désactiver si besoin de passer des options à gdb lui-même
alias gdb='gdb --args'
#maj complète pour les debian-like
alias apt-up='sudo apt-get update && sudo apt-get dist-upgrade'


# -------------------- Git dans tous ses états --------------------
alias gb='git branch'
alias gba='git branch -a'
alias gc='git commit -v'
alias gd='git diff'
alias gl='git pull'
alias gp='git push'
alias gst='git status | less'


# -------------------- Latexmk --------------------
#latexmk : compilateur latex automatique
#nécessite la version patchée pour lui passer les options en paramètres cli
alias latexmk="latexmk -pdfpreviewer gnome-open -dvipreviewer gnome-open -pspreviewer gnome-open"
alias pdflmk="latexmk -pdf"
alias pslmk="latexmk -ps"
alias dvilmk="latexmk -dvi"
alias l='pdflmk'
#visionneur avec recompilation automatique quand changement dans les fichiers sources
alias lview='pdflmk -pvc -silent'
